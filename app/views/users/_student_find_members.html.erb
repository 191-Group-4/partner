<div class="section-group">
<div class="col span_2_of_3">
<table class="table" style="width: 95%!important;">
<span style="font-size:40px; font-weight:bold;"><span class="glyphicons glyphicons-address-book" style="font-size:50px"></span>&ensp;Find
<% project = Project.find(current_user.current_project)%>
<%= project.group_size == 2 ? "a Partner" : "Members"%> </span><br><br>
   <% current_user.groups.order(:project_id).uniq.each do |group| %>
   <% is_current_user_requested = (project.group_relations.find_by(user_id: current_user.id, group_id: group.id).status == 1) %>
	    
	 <% if is_current_user_requested %>
	    <% msg ="You have pending requests, please respond to these before requesting more people."%>
	    	<div class="alert alert-warning">
		     <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
		      <%= content_tag :div, msg.html_safe, id: "flash_success" %></div>
					<%= render 'visitors/requests', project: group.project %>
	 <% else %>

		<% !@mygroup.nil? ? mygroupsize = @mygroup.group_relations.size : mygroupsize = 0 %>
		<!-- Room in group?-->
		<% allowed_size = Project.find(current_user.current_project).group_size %>
		    <% if allowed_size <= mygroupsize %>
			    <% msg ="#{@mygroup.name} is full.  <br>You have <span style= 'font-size: 18px; font-weight:bold;'>#{mygroupsize}</span> members out of the <span style= 'font-size: 18px; font-weight:bold;'>#{allowed_size}</span> members allowed in your group."%>
			<div class="alert alert-warning">
		     <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
		      <%= content_tag :div, msg.html_safe, id: "flash_success" %></div>
		  	<% elsif Project.find(current_user.current_project).partnership_deadline < Date.today %>
			    <% msg ="Partnership Deadline has passed. Contact your Professor."%>
				 <div class="alert alert-danger">
			     <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
			      <%= content_tag :div, msg.html_safe, id: "error" %></div>
		  	<% else %>
		  	<tr style="background-color:#eee">
		      	 <th colspan="2"><b>Name</th>
				      <th class='collapsable'><b>Email</th>
				      <th colspan="2" style="max-width:100px;"><b>
				      	<% allowed_size <= mygroupsize ? "Confirmed?" :  "Request"%></th></b>
				   </tr>
				<!-- Render every user -->
				  <%= render 'users/user_render'%>
			<% end %>
	 <% end %>
	 <% end %>



	 <% if current_user.groups.order(:project_id).empty?%>
	 <tr style="background-color:#eee">
      	 <th colspan="2"><b>Name</th>
		      <th class='collapsable'><b>Email</th>
		      <th colspan="2" style="max-width:100px;"><b>
		   </tr>
		<!-- Render every user -->
		  <%= render 'users/user_render'%>
	<% end %>

	
		</table>
			</div>
				<!-- group sidebar-->
	  	<div class="col span_1_of_3">
	  	  <%= render 'layouts/buttons/course_select'%>
	  	  <% @group = current_user.groups.find_by(project_id: current_user.current_project) %>
		  <%= render 'groups/profile', group: @group %>
		</div>

	</div>
