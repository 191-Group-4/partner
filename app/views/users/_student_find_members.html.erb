<span style="font-size:40px; font-weight:bold;"><span class="glyphicons glyphicons-address-book" style="font-size:50px"></span>&ensp;Find
<% project = Project.find(current_user.current_project)%>
<%= project.group_size == 2 ? "a Partner" : "Members"%> </span><br><br>
<% current_user.groups.order(:project_id).uniq.each do |group| %>

<% if project.group_relations.find_by(user_id: current_user.id, group_id: group.id)%>
<% is_current_user_requested = project.group_relations.find_by(user_id: current_user.id, group_id: group.id)%>
<% if is_current_user_requested.status == 1 %>
<% msg ="You have pending requests, please respond to these before requesting more people."%>
<div class="alert alert-warning">
	<button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
<%= content_tag :div, msg.html_safe, id: "flash_success" %></div>
<%= render 'visitors/notification_student', group: group %>
<% end %>
<% else %>
<% !@mygroup.nil? ? mygroupsize = @mygroup.group_relations.size : mygroupsize = 0 %>
<!-- Room in group?-->
<% allowed_size = project.group_size %>
<% if (allowed_size <= mygroupsize) %>
<% msg ="#{@mygroup.name} is full.  <br>You have <span style= 'font-size: 18px; font-weight:bold;'>#{mygroupsize}</span> members out of the <span style= 'font-size: 18px; font-weight:bold;'>#{allowed_size}</span> members allowed in your group."%>
<div class="alert alert-warning">
	<button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
<%= content_tag :div, msg.html_safe, id: "flash_success" %></div>
<% elsif (project.partnership_deadline && (Project.find(current_user.current_project).partnership_deadline < Date.today)) %>
<% msg ="Partnership Deadline has passed. Contact your Professor."%>
<div class="alert alert-danger">
	<button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
<%= content_tag :div, msg.html_safe, id: "error" %></div>
<% else %>
<div class="panel panel-default">
	<div class="panel-heading"><h4><%= Course.find_by_id(current_user.current_course).course_title %>, <%= project.name %></h4>
	</div>
	<div class="panel-body">
		This is a list of all the available partners for <%= Course.find_by_id(current_user.current_course).course_title %>.<br><br>  

		If you would like to change your course you can do so in the "Change Course and Project" on the top right. <br><br>

		<% project.group_size.times do %>
	    	<span class="glyphicons glyphicons-user"></span>
	    <% end %>
	    &emsp;Your group size should be <%= project.group_size %>.
		<br><br>
		 <%= project.allow_repeat ? '<span class="glyphicons glyphicons-ok-2" style="color:green;"></span>&emsp; You ARE '.html_safe : '<span class="glyphicons glyphicons-ban" style="color:red;"></span>&emsp; You ARE NOT '.html_safe %> allowed to repeat partners from your previous assignments.
	</div>
		<table class="table">
			<tr style="background-color:#eee">
			<th><b>Name</th>
			<th class='collapsable'><b>Email</th>
			<th colspan="2" style="max-width:100px;"><b>
			<% allowed_size <= mygroupsize ? "Confirmed?" :  "Request"%></th></b>
		</tr>
			<!-- Render every user -->
			<%= render 'users/user_render'%>
			<% end %>
			<% end %>
			<% end %>
			<% if current_user.groups.order(:project_id).empty?%>
			<tr style="background-color:#eee">
				<th colspan="2"><b>Name</th>
				<th class='collapsable'><b>Email</th>
				<th colspan="2" style="max-width:100px;"><b>
				</tr>
				<!-- Render every user -->
				<%= render 'users/user_render'%>
				<% end %>
			</table>
		</div></div>  </div>  </div>