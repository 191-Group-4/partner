<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>module Devise::Models::Confirmable - RDoc Documentation</title>

<link href="../../fonts.css" rel="stylesheet">
<link href="../../rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "../../";
</script>

<script src="../../js/jquery.js"></script>
<script src="../../js/navigation.js"></script>
<script src="../../js/search_index.js"></script>
<script src="../../js/search.js"></script>
<script src="../../js/searcher.js"></script>
<script src="../../js/darkfish.js"></script>


<body id="top" role="document" class="module">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../table_of_contents.html#pages">Pages</a>
    <a href="../../table_of_contents.html#classes">Classes</a>
    <a href="../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  
<div class="nav-section">
  <h3>Table of Contents</h3>

  <ul class="link-list" role="directory">
    <li><a href="#module-Devise::Models::Confirmable-label-Options">Options</a>
    <li><a href="#module-Devise::Models::Confirmable-label-Examples">Examples</a>
  </ul>
</div>


  <div id="class-metadata">
    
    
    <div id="includes-section" class="nav-section">
  <h3>Included Modules</h3>

  <ul class="link-list">
  
  
    <li><span class="include">ActionView::Helpers::DateHelper</span>
  
  
  </ul>
</div>

    <div id="extends-section" class="nav-section">
  <h3>Extended With Modules</h3>

  <ul class="link-list">
    
  
    <li><span class="extend">ActiveSupport::Concern</span>
  
  
  </ul>
</div>

    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li class="calls-super" ><a href="#method-c-new">::new</a>
    
    <li ><a href="#method-c-required_fields">::required_fields</a>
    
    <li class="calls-super" ><a href="#method-i-active_for_authentication-3F">#active_for_authentication?</a>
    
    <li ><a href="#method-i-after_confirmation">#after_confirmation</a>
    
    <li ><a href="#method-i-confirm-21">#confirm!</a>
    
    <li ><a href="#method-i-confirmation_period_expired-3F">#confirmation_period_expired?</a>
    
    <li ><a href="#method-i-confirmation_period_valid-3F">#confirmation_period_valid?</a>
    
    <li ><a href="#method-i-confirmation_required-3F">#confirmation_required?</a>
    
    <li ><a href="#method-i-confirmed-3F">#confirmed?</a>
    
    <li ><a href="#method-i-generate_confirmation_token">#generate_confirmation_token</a>
    
    <li ><a href="#method-i-generate_confirmation_token-21">#generate_confirmation_token!</a>
    
    <li class="calls-super" ><a href="#method-i-inactive_message">#inactive_message</a>
    
    <li ><a href="#method-i-pending_any_confirmation">#pending_any_confirmation</a>
    
    <li ><a href="#method-i-pending_reconfirmation-3F">#pending_reconfirmation?</a>
    
    <li ><a href="#method-i-postpone_email_change-3F">#postpone_email_change?</a>
    
    <li ><a href="#method-i-postpone_email_change_until_confirmation_and_regenerate_confirmation_token">#postpone_email_change_until_confirmation_and_regenerate_confirmation_token</a>
    
    <li ><a href="#method-i-reconfirmation_required-3F">#reconfirmation_required?</a>
    
    <li ><a href="#method-i-resend_confirmation_instructions">#resend_confirmation_instructions</a>
    
    <li ><a href="#method-i-send_confirmation_instructions">#send_confirmation_instructions</a>
    
    <li ><a href="#method-i-send_confirmation_notification-3F">#send_confirmation_notification?</a>
    
    <li ><a href="#method-i-send_on_create_confirmation_instructions">#send_on_create_confirmation_instructions</a>
    
    <li ><a href="#method-i-send_reconfirmation_instructions">#send_reconfirmation_instructions</a>
    
    <li ><a href="#method-i-skip_confirmation-21">#skip_confirmation!</a>
    
    <li ><a href="#method-i-skip_confirmation_notification-21">#skip_confirmation_notification!</a>
    
    <li ><a href="#method-i-skip_reconfirmation-21">#skip_reconfirmation!</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="module-Devise::Models::Confirmable">
  <h1 id="module-Devise::Models::Confirmable" class="module">
    module Devise::Models::Confirmable
  </h1>

  <section class="description">
    
<p><a href="Confirmable.html">Confirmable</a> is responsible to verify if an
account is already confirmed to sign in, and to send emails with
confirmation instructions. Confirmation instructions are sent to the user
email after creating a record and when manually requested by a new
confirmation instruction request.</p>

<h2 id="module-Devise::Models::Confirmable-label-Options">Options<span><a href="#module-Devise::Models::Confirmable-label-Options">&para;</a> <a href="#documentation">&uarr;</a></span></h2>

<p><a href="Confirmable.html">Confirmable</a> adds the following options to
<code>devise</code>:</p>

<pre>* +allow_unconfirmed_access_for+: the time you want to allow the user to access their account
  before confirming it. After this period, the user access is denied. You can
  use this to let your user access some features of your application without
  confirming the account, but blocking it after a certain period (ie 7 days).
  By default allow_unconfirmed_access_for is zero, it means users always have to confirm to sign in.
* +reconfirmable+: requires any email changes to be confirmed (exactly the same way as
  initial account confirmation) to be applied. Requires additional unconfirmed_email
  db field to be setup (t.reconfirmable in migrations). Until confirmed new email is
  stored in unconfirmed email column, and copied to email column on successful
  confirmation.
* +confirm_within+: the time before a sent confirmation token becomes invalid.
  You can use this to force the user to confirm within a set period of time.</pre>

<h2 id="module-Devise::Models::Confirmable-label-Examples">Examples<span><a href="#module-Devise::Models::Confirmable-label-Examples">&para;</a> <a href="#documentation">&uarr;</a></span></h2>

<pre>User.find(1).confirm!      # returns true unless it&#39;s already confirmed
User.find(1).confirmed?    # true/false
User.find(1).send_confirmation_instructions # manually send instructions</pre>

  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(*args, &block)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          
            <div class="method-calls-super">
              Calls superclass method
              
            </div>
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/devise/models/confirmable.rb, line 42</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-ivar">@bypass_confirmation_postpone</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-ivar">@reconfirmation_required</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-ivar">@skip_confirmation_notification</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-ivar">@raw_confirmation_token</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">super</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-required_fields" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">required_fields</span><span
            class="method-args">(klass)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="required_fields-source">
            <pre><span class="ruby-comment"># File lib/devise/models/confirmable.rb, line 50</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">required_fields</span>(<span class="ruby-identifier">klass</span>)
  <span class="ruby-identifier">required_methods</span> = [<span class="ruby-value">:confirmation_token</span>, <span class="ruby-value">:confirmed_at</span>, <span class="ruby-value">:confirmation_sent_at</span>]
  <span class="ruby-identifier">required_methods</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value">:unconfirmed_email</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">reconfirmable</span>
  <span class="ruby-identifier">required_methods</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-active_for_authentication-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">active_for_authentication?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Overwrites active_for_authentication? for confirmation by verifying whether
a user is active to sign in or not. If the user is already confirmed, it
should never be blocked. Otherwise we need to calculate if the confirm time
has not expired for this user.</p>
          
          
            <div class="method-calls-super">
              Calls superclass method
              
            </div>
          

          
          <div class="method-source-code" id="active_for_authentication-3F-source">
            <pre><span class="ruby-comment"># File lib/devise/models/confirmable.rb, line 125</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">active_for_authentication?</span>
  <span class="ruby-keyword">super</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-operator">!</span><span class="ruby-identifier">confirmation_required?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">confirmed?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">confirmation_period_valid?</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-confirm-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">confirm!</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Confirm a user by setting it&#39;s confirmed_at to actual time. If the user
is already confirmed, add an error to email field. If the user is invalid
add errors</p>
          
          

          
          <div class="method-source-code" id="confirm-21-source">
            <pre><span class="ruby-comment"># File lib/devise/models/confirmable.rb, line 59</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">confirm!</span>
  <span class="ruby-identifier">pending_any_confirmation</span> <span class="ruby-keyword">do</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">confirmation_period_expired?</span>
      <span class="ruby-keyword">self</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-value">:email</span>, <span class="ruby-value">:confirmation_period_expired</span>,
        <span class="ruby-identifier">period</span><span class="ruby-operator">:</span> <span class="ruby-constant">Devise</span><span class="ruby-operator">::</span><span class="ruby-constant">TimeInflector</span>.<span class="ruby-identifier">time_ago_in_words</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">confirm_within</span>.<span class="ruby-identifier">ago</span>))
      <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">confirmation_token</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">confirmed_at</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">utc</span>

    <span class="ruby-identifier">saved</span> = <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">reconfirmable</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">unconfirmed_email</span>.<span class="ruby-identifier">present?</span>
      <span class="ruby-identifier">skip_reconfirmation!</span>
      <span class="ruby-keyword">self</span>.<span class="ruby-identifier">email</span> = <span class="ruby-identifier">unconfirmed_email</span>
      <span class="ruby-keyword">self</span>.<span class="ruby-identifier">unconfirmed_email</span> = <span class="ruby-keyword">nil</span>

      <span class="ruby-comment"># We need to validate in such cases to enforce e-mail uniqueness</span>
      <span class="ruby-identifier">save</span>(<span class="ruby-identifier">validate</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">save</span>(<span class="ruby-identifier">validate</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>)
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">after_confirmation</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">saved</span>
    <span class="ruby-identifier">saved</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-confirmed-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">confirmed?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Verifies whether a user is confirmed or not</p>
          
          

          
          <div class="method-source-code" id="confirmed-3F-source">
            <pre><span class="ruby-comment"># File lib/devise/models/confirmable.rb, line 87</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">confirmed?</span>
  <span class="ruby-operator">!</span><span class="ruby-operator">!</span><span class="ruby-identifier">confirmed_at</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-inactive_message" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">inactive_message</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>The message to be shown if the account is inactive.</p>
          
          
            <div class="method-calls-super">
              Calls superclass method
              
            </div>
          

          
          <div class="method-source-code" id="inactive_message-source">
            <pre><span class="ruby-comment"># File lib/devise/models/confirmable.rb, line 130</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">inactive_message</span>
  <span class="ruby-operator">!</span><span class="ruby-identifier">confirmed?</span> <span class="ruby-operator">?</span> <span class="ruby-value">:unconfirmed</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">super</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-pending_reconfirmation-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">pending_reconfirmation?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="pending_reconfirmation-3F-source">
            <pre><span class="ruby-comment"># File lib/devise/models/confirmable.rb, line 91</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">pending_reconfirmation?</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">reconfirmable</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">unconfirmed_email</span>.<span class="ruby-identifier">present?</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-resend_confirmation_instructions" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">resend_confirmation_instructions</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Resend confirmation token. Regenerates the token if the period is expired.</p>
          
          

          
          <div class="method-source-code" id="resend_confirmation_instructions-source">
            <pre><span class="ruby-comment"># File lib/devise/models/confirmable.rb, line 115</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">resend_confirmation_instructions</span>
  <span class="ruby-identifier">pending_any_confirmation</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">send_confirmation_instructions</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-send_confirmation_instructions" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">send_confirmation_instructions</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Send confirmation instructions by email</p>
          
          

          
          <div class="method-source-code" id="send_confirmation_instructions-source">
            <pre><span class="ruby-comment"># File lib/devise/models/confirmable.rb, line 96</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">send_confirmation_instructions</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@raw_confirmation_token</span>
    <span class="ruby-identifier">generate_confirmation_token!</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">pending_reconfirmation?</span> <span class="ruby-operator">?</span> { <span class="ruby-identifier">to</span><span class="ruby-operator">:</span> <span class="ruby-identifier">unconfirmed_email</span> } <span class="ruby-operator">:</span> { }
  <span class="ruby-identifier">send_devise_notification</span>(<span class="ruby-value">:confirmation_instructions</span>, <span class="ruby-ivar">@raw_confirmation_token</span>, <span class="ruby-identifier">opts</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-send_reconfirmation_instructions" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">send_reconfirmation_instructions</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="send_reconfirmation_instructions-source">
            <pre><span class="ruby-comment"># File lib/devise/models/confirmable.rb, line 105</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">send_reconfirmation_instructions</span>
  <span class="ruby-ivar">@reconfirmation_required</span> = <span class="ruby-keyword">false</span>

  <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@skip_confirmation_notification</span>
    <span class="ruby-identifier">send_confirmation_instructions</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-skip_confirmation-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">skip_confirmation!</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>If you don&#39;t want confirmation to be sent on create, neither a code to
be generated, call skip_confirmation!</p>
          
          

          
          <div class="method-source-code" id="skip_confirmation-21-source">
            <pre><span class="ruby-comment"># File lib/devise/models/confirmable.rb, line 136</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">skip_confirmation!</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">confirmed_at</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">utc</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-skip_confirmation_notification-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">skip_confirmation_notification!</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Skips sending the confirmation/reconfirmation notification email
after_create/after_update. Unlike <a
href="Confirmable.html#method-i-skip_confirmation-21">skip_confirmation!</a>,
record still requires confirmation.</p>
          
          

          
          <div class="method-source-code" id="skip_confirmation_notification-21-source">
            <pre><span class="ruby-comment"># File lib/devise/models/confirmable.rb, line 142</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">skip_confirmation_notification!</span>
  <span class="ruby-ivar">@skip_confirmation_notification</span> = <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-skip_reconfirmation-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">skip_reconfirmation!</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>If you don&#39;t want reconfirmation to be sent, neither a code to be
generated, call skip_reconfirmation!</p>
          
          

          
          <div class="method-source-code" id="skip_reconfirmation-21-source">
            <pre><span class="ruby-comment"># File lib/devise/models/confirmable.rb, line 148</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">skip_reconfirmation!</span>
  <span class="ruby-ivar">@bypass_confirmation_postpone</span> = <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="protected-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Protected Instance Methods</h3>
       </header>

    
      <div id="method-i-after_confirmation" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">after_confirmation</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="after_confirmation-source">
            <pre><span class="ruby-comment"># File lib/devise/models/confirmable.rb, line 252</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">after_confirmation</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-confirmation_period_expired-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">confirmation_period_expired?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Checks if the user confirmation happens before the token becomes invalid
Examples:</p>

<pre># confirm_within = 3.days and confirmation_sent_at = 2.days.ago
confirmation_period_expired?  # returns false

# confirm_within = 3.days and confirmation_sent_at = 4.days.ago
confirmation_period_expired?  # returns true

# confirm_within = nil
confirmation_period_expired?  # will always return false</pre>
          
          

          
          <div class="method-source-code" id="confirmation_period_expired-3F-source">
            <pre><span class="ruby-comment"># File lib/devise/models/confirmable.rb, line 204</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">confirmation_period_expired?</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">confirm_within</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span> <span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">confirmation_sent_at</span> <span class="ruby-operator">+</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">confirm_within</span> )
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-confirmation_period_valid-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">confirmation_period_valid?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Checks if the confirmation for the user is within the limit time. We do
this by calculating if the difference between today and the confirmation
sent date does not exceed the confirm in time configured. Confirm_within is
a model configuration, must always be an integer value.</p>

<p>Example:</p>

<pre># allow_unconfirmed_access_for = 1.day and confirmation_sent_at = today
confirmation_period_valid?   # returns true

# allow_unconfirmed_access_for = 5.days and confirmation_sent_at = 4.days.ago
confirmation_period_valid?   # returns true

# allow_unconfirmed_access_for = 5.days and confirmation_sent_at = 5.days.ago
confirmation_period_valid?   # returns false

# allow_unconfirmed_access_for = 0.days
confirmation_period_valid?   # will always return false

# allow_unconfirmed_access_for = nil
confirmation_period_valid?   # will always return true</pre>
          
          

          
          <div class="method-source-code" id="confirmation_period_valid-3F-source">
            <pre><span class="ruby-comment"># File lib/devise/models/confirmable.rb, line 188</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">confirmation_period_valid?</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">allow_unconfirmed_access_for</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> (<span class="ruby-identifier">confirmation_sent_at</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">confirmation_sent_at</span>.<span class="ruby-identifier">utc</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">allow_unconfirmed_access_for</span>.<span class="ruby-identifier">ago</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-confirmation_required-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">confirmation_required?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Callback to overwrite if confirmation is required or not.</p>
          
          

          
          <div class="method-source-code" id="confirmation_required-3F-source">
            <pre><span class="ruby-comment"># File lib/devise/models/confirmable.rb, line 162</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">confirmation_required?</span>
  <span class="ruby-operator">!</span><span class="ruby-identifier">confirmed?</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-generate_confirmation_token" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">generate_confirmation_token</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Generates a new random token for confirmation, and stores the time this
token is being generated</p>
          
          

          
          <div class="method-source-code" id="generate_confirmation_token-source">
            <pre><span class="ruby-comment"># File lib/devise/models/confirmable.rb, line 220</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">generate_confirmation_token</span>
  <span class="ruby-identifier">raw</span>, <span class="ruby-identifier">enc</span> = <span class="ruby-constant">Devise</span>.<span class="ruby-identifier">token_generator</span>.<span class="ruby-identifier">generate</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>, <span class="ruby-value">:confirmation_token</span>)
  <span class="ruby-ivar">@raw_confirmation_token</span>   = <span class="ruby-identifier">raw</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">confirmation_token</span>   = <span class="ruby-identifier">enc</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">confirmation_sent_at</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">utc</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-generate_confirmation_token-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">generate_confirmation_token!</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="generate_confirmation_token-21-source">
            <pre><span class="ruby-comment"># File lib/devise/models/confirmable.rb, line 227</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">generate_confirmation_token!</span>
  <span class="ruby-identifier">generate_confirmation_token</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">save</span>(<span class="ruby-identifier">validate</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-pending_any_confirmation" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">pending_any_confirmation</span><span
            class="method-args">() { || ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Checks whether the record requires any confirmation.</p>
          
          

          
          <div class="method-source-code" id="pending_any_confirmation-source">
            <pre><span class="ruby-comment"># File lib/devise/models/confirmable.rb, line 209</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">pending_any_confirmation</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-identifier">confirmed?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">pending_reconfirmation?</span>)
    <span class="ruby-keyword">yield</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-value">:email</span>, <span class="ruby-value">:already_confirmed</span>)
    <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-postpone_email_change-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">postpone_email_change?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="postpone_email_change-3F-source">
            <pre><span class="ruby-comment"># File lib/devise/models/confirmable.rb, line 238</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">postpone_email_change?</span>
  <span class="ruby-identifier">postpone</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">reconfirmable</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">email_changed?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@bypass_confirmation_postpone</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">email</span>.<span class="ruby-identifier">present?</span>
  <span class="ruby-ivar">@bypass_confirmation_postpone</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-identifier">postpone</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-postpone_email_change_until_confirmation_and_regenerate_confirmation_token" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">postpone_email_change_until_confirmation_and_regenerate_confirmation_token</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="postpone_email_change_until_confirmation_and_regenerate_confirmation_token-source">
            <pre><span class="ruby-comment"># File lib/devise/models/confirmable.rb, line 231</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">postpone_email_change_until_confirmation_and_regenerate_confirmation_token</span>
  <span class="ruby-ivar">@reconfirmation_required</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">unconfirmed_email</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">email</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">email</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">email_was</span>
  <span class="ruby-identifier">generate_confirmation_token</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-reconfirmation_required-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">reconfirmation_required?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="reconfirmation_required-3F-source">
            <pre><span class="ruby-comment"># File lib/devise/models/confirmable.rb, line 244</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">reconfirmation_required?</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">reconfirmable</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@reconfirmation_required</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">email</span>.<span class="ruby-identifier">present?</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-send_confirmation_notification-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">send_confirmation_notification?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="send_confirmation_notification-3F-source">
            <pre><span class="ruby-comment"># File lib/devise/models/confirmable.rb, line 248</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">send_confirmation_notification?</span>
  <span class="ruby-identifier">confirmation_required?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@skip_confirmation_notification</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">email</span>.<span class="ruby-identifier">present?</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-send_on_create_confirmation_instructions" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">send_on_create_confirmation_instructions</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>A callback method used to deliver confirmation instructions on creation.
This can be overridden in models to map to a nice sign up e-mail.</p>
          
          

          
          <div class="method-source-code" id="send_on_create_confirmation_instructions-source">
            <pre><span class="ruby-comment"># File lib/devise/models/confirmable.rb, line 157</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">send_on_create_confirmation_instructions</span>
  <span class="ruby-identifier">send_confirmation_instructions</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://rdoc.rubyforge.org">RDoc</a> 4.1.2.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

